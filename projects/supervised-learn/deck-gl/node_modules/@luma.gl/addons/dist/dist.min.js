!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("luma"));else if("function"==typeof define&&define.amd)define(["luma"],t);else{var r="object"==typeof exports?t(require("luma")):t(e.luma);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(window,function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){e.exports=r(16)},function(t,r){t.exports=e},function(e,t){e.exports={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,FUNC_ADD:32774,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,BLEND_COLOR:32773,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,VENDOR:7936,RENDERER:7937,VERSION:7938,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,BROWSER_DEFAULT_WEBGL:37444,STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:35048,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,CULL_FACE:2884,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,BLEND:3042,DEPTH_TEST:2929,DITHER:3024,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,SCISSOR_TEST:3089,STENCIL_TEST:2960,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CONTEXT_LOST_WEBGL:37442,CW:2304,CCW:2305,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,COMPILE_STATUS:35713,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_ATTRIBUTES:35721,ACTIVE_UNIFORMS:35718,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,ALWAYS:519,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,GEQUAL:518,NOTEQUAL:517,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,TEXTURE_WIDTH:4096,TEXTURE_HEIGHT:4097,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,MAX_3D_TEXTURE_SIZE:32883,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,MAX_TEXTURE_LOD_BIAS:34045,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,RASTERIZER_DISCARD:35977,VERTEX_ARRAY_BINDING:34229,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,MAX_ELEMENT_INDEX:36203,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,RGB9_E5:35901,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2UI:36975,TEXTURE_IMMUTABLE_FORMAT:37167,TEXTURE_IMMUTABLE_LEVELS:33503,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,INT_2_10_10_10_REV:36255,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,MAX_SAMPLES:36183,SAMPLER_BINDING:35097,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,UNSIGNED_NORMALIZED:35863,SIGNED_NORMALIZED:36764,VERTEX_ATTRIB_ARRAY_INTEGER:35069,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,DEPTH24_STENCIL8:35056,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,COLOR:6144,DEPTH:6145,STENCIL:6146,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,INVALID_INDEX:4294967295,TIMEOUT_IGNORED:-1,MAX_CLIENT_WAIT_TIMEOUT_WEBGL:37447,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,UNMASKED_VENDOR_WEBGL:37445,UNMASKED_RENDERER_WEBGL:37446,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,TEXTURE_MAX_ANISOTROPY_EXT:34046,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35986,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,UNSIGNED_INT_24_8_WEBGL:34042,HALF_FLOAT_OES:36193,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863,MIN_EXT:32775,MAX_EXT:32776,SRGB_EXT:35904,SRGB_ALPHA_EXT:35906,SRGB8_ALPHA8_EXT:35907,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067,COLOR_ATTACHMENT4_WEBGL:36068,COLOR_ATTACHMENT5_WEBGL:36069,COLOR_ATTACHMENT6_WEBGL:36070,COLOR_ATTACHMENT7_WEBGL:36071,COLOR_ATTACHMENT8_WEBGL:36072,COLOR_ATTACHMENT9_WEBGL:36073,COLOR_ATTACHMENT10_WEBGL:36074,COLOR_ATTACHMENT11_WEBGL:36075,COLOR_ATTACHMENT12_WEBGL:36076,COLOR_ATTACHMENT13_WEBGL:36077,COLOR_ATTACHMENT14_WEBGL:36078,COLOR_ATTACHMENT15_WEBGL:36079,DRAW_BUFFER0_WEBGL:34853,DRAW_BUFFER1_WEBGL:34854,DRAW_BUFFER2_WEBGL:34855,DRAW_BUFFER3_WEBGL:34856,DRAW_BUFFER4_WEBGL:34857,DRAW_BUFFER5_WEBGL:34858,DRAW_BUFFER6_WEBGL:34859,DRAW_BUFFER7_WEBGL:34860,DRAW_BUFFER8_WEBGL:34861,DRAW_BUFFER9_WEBGL:34862,DRAW_BUFFER10_WEBGL:34863,DRAW_BUFFER11_WEBGL:34864,DRAW_BUFFER12_WEBGL:34865,DRAW_BUFFER13_WEBGL:34866,DRAW_BUFFER14_WEBGL:34867,DRAW_BUFFER15_WEBGL:34868,MAX_COLOR_ATTACHMENTS_WEBGL:36063,MAX_DRAW_BUFFERS_WEBGL:34852,VERTEX_ARRAY_BINDING_OES:34229,QUERY_COUNTER_BITS_EXT:34916,CURRENT_QUERY_EXT:34917,QUERY_RESULT_EXT:34918,QUERY_RESULT_AVAILABLE_EXT:34919,TIME_ELAPSED_EXT:35007,TIMESTAMP_EXT:36392,GPU_DISJOINT_EXT:36795}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}r.d(t,"a",function(){return i})},function(e,t,r){"use strict";(function(e,n){r.d(t,"b",function(){return s}),r.d(t,"a",function(){return a}),r.d(t,"c",function(){return c});var i=r(3),s="object"!==(void 0===e?"undefined":Object(i.a)(e))||"[object process]"!==String(e)||e.browser,o={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n&&n,document:"undefined"!=typeof document&&document},a=o.global||o.self||o.window,u=void 0!==e&&e.version.match(/v([0-9]*)/),c=u&&parseFloat(u[1])||0}).call(this,r(17),r(11))},,,,,,,function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){(function(t){const n=r(18),i="undefined"==typeof window?t:window;i.loaders=i.luma||{},e.exports=Object.assign(i.luma,n)}).call(this,r(11))},,,,function(e,t,r){var n=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function u(e,t,r,n){var i=t&&t.prototype instanceof T?t:T,s=Object.create(i.prototype),o=new O(n||[]);return s._invoke=function(e,t,r){var n=f;return function(i,s){if(n===l)throw new Error("Generator is already running");if(n===E){if("throw"===i)throw s;return L()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=S(o,r);if(a){if(a===_)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=E,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=l;var u=c(e,t,r);if("normal"===u.type){if(n=r.done?E:h,u.arg===_)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=E,r.method="throw",r.arg=u.arg)}}}(e,r,o),s}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var f="suspendedStart",h="suspendedYield",l="executing",E="completed",_={};function T(){}function v(){}function A(){}var R={};R[s]=function(){return this};var d=Object.getPrototypeOf,y=d&&d(d(I([])));y&&y!==r&&n.call(y,s)&&(R=y);var g=A.prototype=T.prototype=Object.create(R);function p(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function m(e){var t;this._invoke=function(r,i){function s(){return new Promise(function(t,s){!function t(r,i,s,o){var a=c(e[r],e,i);if("throw"!==a.type){var u=a.arg,f=u.value;return f&&"object"==typeof f&&n.call(f,"__await")?Promise.resolve(f.__await).then(function(e){t("next",e,s,o)},function(e){t("throw",e,s,o)}):Promise.resolve(f).then(function(e){u.value=e,s(u)},function(e){return t("throw",e,s,o)})}o(a.arg)}(r,i,t,s)})}return t=t?t.then(s,s):s()}}function S(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method))return _;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var i=c(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,_;var s=i.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,_):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function I(e){if(e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:L}}function L(){return{value:t,done:!0}}return v.prototype=g.constructor=A,A.constructor=v,A[a]=v.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,A):(e.__proto__=A,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},p(m.prototype),m.prototype[o]=function(){return this},e.AsyncIterator=m,e.async=function(t,r,n,i){var s=new m(u(t,r,n,i));return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},p(g),g[a]="Generator",g[s]=function(){return this},g.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,_):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;M(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),_}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t){var r,n,i=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(e){r=s}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var u,c=[],f=!1,h=-1;function l(){f&&u&&(f=!1,u.length?c=u.concat(c):h=-1,c.length&&E())}function E(){if(!f){var e=a(l);f=!0;for(var t=c.length;t;){for(u=c,c=[];++h<t;)u&&u[h].run();h=-1,t=c.length}u=null,f=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function T(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new _(e,t)),1!==c.length||f||a(E)},_.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=T,i.addListener=T,i.once=T,i.off=T,i.removeListener=T,i.removeAllListeners=T,i.emit=T,i.prependListener=T,i.prependOnceListener=T,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"KHR_draco_mesh_compression",function(){return re}),r.d(n,"KHR_lights_punctual",function(){return ne});var i=r(1);class s{getViews(e){const{width:t,height:r}=e;return[{params:{viewport:[0,0,t,r],scissor:[0,0,t,r],scissorTest:!0}}]}submitFrame(){return!0}requestAnimationFrame(e){return!1}delete(){}_renderFrame(e){const t=this.getViews(e);if(!t)return!1;const{gl:r}=this.animationLoop;for(const n of t)Object(i.withParameters)(r,n.params,()=>this.animationLoop.onRender({...e,...n}));return this.submitFrame(),!0}}class o extends s{static isSupported(){return"undefined"!=typeof navigator&&"getVRDisplays"in navigator&&"VRFrameData"in window}constructor(e){super(e),this._vrSupported=o.isSupported(),this._vrSupported&&(this.vrFrameData=new window.VRFrameData,this.vrPresenting=!1,this.vrFrame=!1,window.addEventListener("vrdisplaypresentchange",this._vrDisplayPresentChange.bind(this)))}delete(){super.delete(),this._removeVRButton()}getViews(e){if(this._vrSupported&&this._addVRButton(),this.vrPresenting&&this.vrFrame){this.vrDisplay.getFrameData(this.vrFrameData);const{leftProjectionMatrix:t,leftViewMatrix:r,rightProjectionMatrix:n,rightViewMatrix:i}=this.vrFrameData,{width:s,height:o}=e;return[{displayEye:"left",projectionMatrix:t,viewMatrix:r,params:{viewport:[0,0,.5*s,o],scissor:[0,0,.5*s,o],scissorTest:!0}},{displayEye:"right",projectionMatrix:n,viewMatrix:i,params:{viewport:[.5*s,0,.5*s,o],scissor:[.5*s,0,.5*s,o],scissorTest:!0}}]}return super.getViews(e)}submitFrame(){return!(!this.vrPresenting||!this.vrFrame)&&(this.vrDisplay.submitFrame(),!0)}requestAnimationFrame(e){return!!this.vrPresenting&&(this.vrDisplay.requestAnimationFrame(()=>{this.vrFrame=!0,e(),this.vrFrame=!1}),!0)}async _addVRButton(){if(this.vrButton)return;const e=this._getCanvas();if(!e)return;const t=await navigator.getVRDisplays();t&&t.length&&(i.log.info(2,"Found VR Displays",t)(),this.vrDisplay=t[0],this.vrButton=function({canvas:e,title:t}){const{top:r,left:n,width:i,height:s}=e.getBoundingClientRect(),o=document.createElement("div");o.style.position="absolute",o.style.top=`${r}px`,o.style.left=`${n}px`,o.style.width=`${i}px`,o.style.height=`${s}px`,o.style.pointerEvents="none",o.style.zIndex="999",document.body.appendChild(o);const a=document.createElement("button");return a.style.padding="16px",a.style.border="1px solid #fff",a.style.borderRadius="8px",a.style.background="rgba(0,0,0,0.5)",a.style.color="#fff",a.style.font="normal 20px sans-serif",a.style.cursor="pointer",a.style.margin="20px auto",a.style.display="block",a.style.pointerEvents="all",a.textContent=t,o.appendChild(a),a}({canvas:e,title:`Enter VR (${this.vrDisplay.displayName})`}),this.vrButton.onclick=()=>this._startDisplay())}_getCanvas(){return this.animationLoop.canvas||this.animationLoop.gl&&this.animationLoop.gl.canvas}_removeVRButton(){this.vrButton}_startDisplay(){this.vrDisplay.requestPresent([{source:this._getCanvas()}])}_vrDisplayPresentChange(){this.vrDisplay.isPresenting?(i.log.info(2,"Entering VR")(),this.vrPresenting=!0,this.vrButton.style.display="none"):(i.log.info(2,"Exiting VR")(),this.vrPresenting=!1,this.vrButton.style.display="block")}}var a=r(0),u=r.n(a);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t,r,n,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function h(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var s=e.apply(t,r);function o(e){f(s,n,i,o,a,"next",e)}function a(e){f(s,n,i,o,a,"throw",e)}o(void 0)})}}var l=r(3),E=function(e){return function(e){return"undefined"!=typeof File&&e instanceof File}(e)||function(e){return"undefined"!=typeof Blob&&e instanceof Blob}(e)},_="",T={};function v(e){for(var t in T)if(e.startsWith(t)){var r=T[t];return e.replace(t,r)}return e+=_}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,r){return t&&R(e.prototype,t),r&&R(e,r),e}function y(e,t){if(!e)throw new Error(t||"loader assertion failed.")}var g=function(){function e(t){A(this,e),this._fileOrBlob=t,this.bodyUsed=!1}return d(e,[{key:"url",value:function(){return this._fileOrBlob.name||""}},{key:"arrayBuffer",value:function(){var e=h(u.a.mark(function e(){var t,r,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._getFileReader(),r=t.reader,n=t.promise,r.readAsArrayBuffer(this._fileOrBlob),e.abrupt("return",n);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"text",value:function(){var e=h(u.a.mark(function e(){var t,r,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._getFileReader(),r=t.reader,n=t.promise,r.readAsText(this._fileOrBlob),e.abrupt("return",n);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"json",value:function(){var e=h(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.text();case 2:return t=e.sent,e.abrupt("return",JSON.parse(t));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_getFileReader",value:function(){var e;y(!this.bodyUsed),this.bodyUsed=!0;var t=new Promise(function(t,r){try{(e=new FileReader).onerror=function(e){return r(new Error(e))},e.onabort=function(){return r(new Error("Read aborted."))},e.onload=function(){return t(e.result)}}catch(e){r(e)}});return{reader:e,promise:t}}},{key:"headers",get:function(){return new Headers({"Content-Length":this._fileOrBlob.size,"Content-Type":this._fileOrBlob.type})}}]),e}();function p(e,t){return Promise.resolve(new g(e,t))}function m(e,t){return S.apply(this,arguments)}function S(){return(S=h(u.a.mark(function e(t,r){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!E(t)){e.next=2;break}return e.abrupt("return",p(t,r));case 2:return t=v(t),e.abrupt("return",fetch(t,r));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function N(e,t){if(!e)throw new Error(t||"gltf/glb assertion failed.")}var M=["SCALAR","VEC2","VEC3","VEC4"],O=new Map([[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126]]),I={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},L={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},F={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function C(e){return M[e-1]||M[0]}function b(e){var t=O.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function B(e,t){var r=F[e.componentType],n=I[e.type],i=L[e.componentType],s=e.count*n,o=e.count*n*i;return N(o>=0&&o<=t.byteLength),{ArrayType:r,length:s,byteLength:o}}function U(e,t){return e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:")?e:t.substr(0,t.lastIndexOf("/")+1)+e}function P(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function w(e){return e+3&-4}function k(e,t,r){var n;if(e instanceof ArrayBuffer)n=new Uint8Array(e);else{var i=e.byteOffset,s=e.byteLength;n=new Uint8Array(e.buffer,i,s)}return t.set(n,r),r+w(n.byteLength)}var D=1735152710,x=12,G=8,V=1313821514,j=5130562,X=!0,H=!1;function W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=new DataView(e),i=r.magic,s=void 0===i?D:i,o=n.getUint32(t,!1);return o===s||o===D}function K(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=new DataView(t);e.byteOffset=r,e.magic=i.getUint32(r+0,H),e.version=i.getUint32(r+4,X),e.byteLength=i.getUint32(r+8,X),e.type=function(e){return"".concat(String.fromCharCode(e.getUint8(0))).concat(String.fromCharCode(e.getUint8(1))).concat(String.fromCharCode(e.getUint8(2))).concat(String.fromCharCode(e.getUint8(3)))}(i);var s=n.magic,o=void 0===s?D:s;e.magic===D||e.magic===o||console.warn("Invalid GLB magic string ".concat(e.type)),P(2===e.version,"Invalid GLB version ".concat(e.version,". Only .glb v2 supported")),P(e.byteLength>20);var a=i.getUint32(r+12,X),u=i.getUint32(r+16,X);P(u===V||0===u,"JSON chunk format ".concat(u));var c=x+G,f=new Uint8Array(t,r+c,a),h=new TextDecoder("utf8").decode(f);e.json=JSON.parse(h);var l=c+w(a);if(e.hasBinChunk=l+8<=e.byteLength,e.hasBinChunk){var E=i.getUint32(r+l+0,X),_=i.getUint32(r+l+4,X);P(_===j||1===_,"BIN chunk format ".concat(_));var T=l+G;e.binChunkByteOffset=T,e.binChunkLength=E}return r+e.byteLength}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var q=!1,Z=!0,z=new Map([["image/png",{test:function(e){return e.byteLength>=24&&2303741511===e.getUint32(0,q)},getSize:function(e){return{width:e.getUint32(16,q),height:e.getUint32(20,q)}}}],["image/jpeg",{test:function(e){return e.byteLength>=2&&65496===e.getUint16(0,q)},getSize:function(e){if(e.byteLength<2||65496!==e.getUint16(0,q))return null;var t=function(){for(var e=new Set([65499,65476,65484,65501,65534]),t=65504;t<65520;++t)e.add(t);var r=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:r}}(),r=t.tableMarkers,n=t.sofMarkers,i=2;for(;i<e.byteLength;){var s=e.getUint16(i,q);if(n.has(s))return{height:e.getUint16(i+5,q),width:e.getUint16(i+7,q)};if(!r.has(s))return null;i+=2,i+=e.getUint16(i,q)}return null}}],["image/gif",{test:function(e){return e.byteLength>=10&&1195984440===e.getUint32(0,q)},getSize:function(e){return{width:e.getUint16(6,Z),height:e.getUint16(8,Z)}}}],["image/bmp",{test:function(e){return e.byteLength>=2&&16973===e.getUint16(0,q)},getSize:function(e){return{width:e.getUint32(18,Z),height:e.getUint32(22,Z)}}}]]);"Invalid MIME type. Supported MIME types are: ".concat(Array.from(z.keys()).join(", "));function Q(e){var t=$(e),r=!0,n=!1,i=void 0;try{for(var s,o=z.entries()[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var a=Y(s.value,2),u=a[0];if((0,a[1].test)(t))return u}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return null}function $(e){if(e instanceof ArrayBuffer||ArrayBuffer.isView(e))return new DataView(e.buffer||e);throw new Error("toDataView")}var J=function(){function e(t){if(A(this,e),t instanceof e)return t;t||(t={json:{version:2,buffers:[]},binary:null}),this.gltf=t}return d(e,[{key:"getApplicationData",value:function(e){return this.json[e]}},{key:"getExtraData",value:function(e){return(this.json.extras||{})[e]}},{key:"getExtension",value:function(e){var t=this.getUsedExtensions().find(function(t){return t===e}),r=this.json.extensions||{};return t?r[e]||!0:null}},{key:"getRequiredExtension",value:function(e){return this.getRequiredExtensions().find(function(t){return t===e})?this.getExtension(e):null}},{key:"getRequiredExtensions",value:function(){return this.json.extensionsRequired||[]}},{key:"getUsedExtensions",value:function(){return this.json.extensionsUsed||[]}},{key:"getObjectExtension",value:function(e,t){return(e.extensions||{})[t]}},{key:"getScene",value:function(e){return this.getObject("scenes",e)}},{key:"getNode",value:function(e){return this.getObject("nodes",e)}},{key:"getSkin",value:function(e){return this.getObject("skins",e)}},{key:"getMesh",value:function(e){return this.getObject("meshes",e)}},{key:"getMaterial",value:function(e){return this.getObject("materials",e)}},{key:"getAccessor",value:function(e){return this.getObject("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this.getObject("textures",e)}},{key:"getSampler",value:function(e){return this.getObject("samplers",e)}},{key:"getImage",value:function(e){return this.getObject("images",e)}},{key:"getBufferView",value:function(e){return this.getObject("bufferViews",e)}},{key:"getBuffer",value:function(e){return this.getObject("buffers",e)}},{key:"getObject",value:function(e,t){if("object"===Object(l.a)(t))return t;var r=this.gltf[e]&&this.gltf[e][t];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),r}},{key:"getTypedArrayForBufferView",value:function(e){e=this.getBufferView(e);var t=this.getBuffer(e.buffer).data,r=e.byteOffset||0;return new Uint8Array(t,r,e.byteLength)}},{key:"getTypedArrayForAccessor",value:function(e){e=this.getAccessor(e);var t=this.getBuffer(e.bufferView),r=this.getBuffer(t.buffer).data,n=B(e,t),i=n.ArrayType,s=n.length;return new i(r,t.byteOffset+e.byteOffset,s)}},{key:"getTypedArrayForImageData",value:function(e){e=this.getAccessor(e);var t=this.getBuffer(e.bufferView),r=this.getBuffer(t.buffer).data,n=t.byteOffset||0;return new Uint8Array(r,n,t.byteLength)}},{key:"addApplicationData",value:function(e,t){return this.json[e]=t,this}},{key:"addExtraData",value:function(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}},{key:"addExtension",value:function(e,t){return N(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),this}},{key:"addRequiredExtension",value:function(e,t){return N(t),this.addExtension(e,t),this.registerRequiredExtension(e),this}},{key:"registerUsedExtension",value:function(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(function(t){return t===e})||this.json.extensionsUsed.push(e)}},{key:"registerRequiredExtension",value:function(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(function(t){return t===e})||this.json.extensionsRequired.push(e)}},{key:"removeExtension",value:function(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}},{key:"setObjectExtension",value:function(e,t,r){(e.extensions||{})[t]=r}},{key:"addMesh",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n={primitives:[{attributes:this._addAttributes(e),indices:t,mode:r}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(n),this.json.meshes.length-1}},{key:"addPointCloud",value:function(e){var t={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(t),this.json.meshes.length-1}},{key:"addImage",value:function(e,t){t=t||Q(e);var r={bufferView:this.addBufferView(e),mimeType:t};return this.json.images=this.json.images||[],this.json.images.push(r),this.json.images.length-1}},{key:"addBufferView",value:function(e){var t=e.byteLength;N(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);var r={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=w(t),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(r),this.json.bufferViews.length-1}},{key:"addAccessor",value:function(e,t){var r={bufferView:e,type:C(t.size),componentType:t.componentType,count:t.count};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}},{key:"addBinaryBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:3},r=this.addBufferView(e),n={size:t.size,componentType:b(e),count:Math.round(e.length/t.size)};return this.addAccessor(r,Object.assign(n,t))}},{key:"createBinaryChunk",value:function(){if(!this.arrayBuffer){for(var e=this.byteLength,t=new ArrayBuffer(e),r=new Uint8Array(t),n=0,i=0;i<this.sourceBuffers.length;i++){n=k(this.sourceBuffers[i],r,n)}this.json.buffers[0].byteLength=e,this.arrayBuffer=t,this.sourceBuffers=[]}}},{key:"_removeStringFromArray",value:function(e,t){for(var r=!0;r;){var n=e.indexOf(t);n>-1?e.splice(n,1):r=!1}}},{key:"json",get:function(){return this.gltf.json}}]),e}();function ee(e){var t={};for(var r in e){var n=e[r];if("indices"!==r){var i=te(n);t[r]=i}}return t}function te(e,t){var r=function(e,t){var r=e,n=1,i=0;e&&e.value&&(r=e.value,n=e.size||1);r&&(ArrayBuffer.isView(r)||(r=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;if(Array.isArray(e))return new t(e);if(r&&!(e instanceof t))return new t(e);return e}(r,Float32Array)),i=r.length/n);return{buffer:r,size:n,count:i}}(e),n=r.buffer,i=r.size;return{value:n,size:i,bufferView:null,byteOffset:0,count:r.count,type:C(i),componentType:b(n)}}var re=function(){function e(){A(this,e)}return d(e,null,[{key:"decode",value:function(t,r){var n=new J(t),i=!0,s=!1,o=void 0;try{for(var a,u=(n.json.meshes||[])[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var c=a.value;e.decompressMesh(c,r)}}catch(e){s=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(s)throw o}}n.removeExtension("KHR_draco_mesh_compression")}},{key:"encode",value:function(t,r){var n=new J(t),i=!0,s=!1,o=void 0;try{for(var a,u=(n.json.meshes||[])[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var c=a.value;e.compressMesh(c,r),n.addRequiredExtension("KHR_draco_mesh_compression")}}catch(e){s=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(s)throw o}}}},{key:"compressMesh",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!n.DracoWriter||!n.DracoLoader)throw new Error("DracoWriter/DracoLoader not available");var i=n.DracoWriter.encodeSync({attributes:e}),s=n.DracoLoader.parseSync({attributes:e}),o=n._addFauxAttributes(s.attributes);return{primitives:[{attributes:o,mode:r,extensions:c({},"KHR_draco_mesh_compression",{bufferView:n.addBufferView(i),attributes:o})}]}}},{key:"decompressMesh",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!0,i=!1,s=void 0;try{for(var o,a=t.primitives[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value;if(e._decompressMeshPrimitive(u,r),!u.attributes||0===Object.keys(u.attributes).length)throw new Error("Empty glTF primitive: decompression failure?")}}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}}},{key:"_decompressMeshPrimitive",value:function(e,t){var r=e.extensions&&e.extensions.KHR_draco_mesh_compression;if(r&&t.DracoLoader&&t.decompress){delete e.extensions.KHR_draco_mesh_compression;var n=this._getBufferViewArray(r.bufferView),i=t.DracoLoader.parseSync(n);e.attributes=ee(i.attributes),i.indices&&(e.indices=te(i.indices))}}},{key:"name",get:function(){return"KHR_draco_mesh_compression"}}]),e}(),ne=function(){function e(){A(this,e)}return d(e,null,[{key:"decode",value:function(e,t){var r=new J(e),n=r.getExtension("KHR_lights_punctual");n&&(r.json.lights=n.lights,r.removeExtension("KHR_lights_punctual"));var i=!0,s=!1,o=void 0;try{for(var a,u=(r.nodes||[])[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var c=a.value,f=c.extensions&&c.extensions.KHR_lights_punctual;f&&(c.light=r._get("lights",f.light),delete c.extensions.KHR_lights_punctual)}}catch(e){s=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(s)throw o}}}},{key:"encode",value:function(e,t){var r=new J(e),n=r.json;if(n.lights){var i=r.addExtensions("KHR_lights_punctual");N(!i.lights),i.lights=n.lights,delete n.lights}if(r.json.lights){var s=!0,o=!1,a=void 0;try{for(var u,c=r.json.lights[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var f=u.value,h=f.node;r.addObjectExtension(h,"KHR_lights_punctual",f)}}catch(e){o=!0,a=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw a}}delete r.json.lights}}},{key:"name",get:function(){return"KHR_lights_punctual"}}]),e}();function ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ie(r,!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ie(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var oe={fetchLinkedResources:!1,decompress:!1,DracoLoader:null,postProcess:!0,createImages:!1,log:console},ae={fetchLinkedResources:!0,fetch:m,decompress:!1,DracoLoader:null,postProcess:!0,createImages:!1,log:console};function ue(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};i=Object.assign({},oe,i);var s=t;s instanceof ArrayBuffer&&!W(s,r,i)&&(s=(new TextDecoder).decode(s));if(e.buffers=[],"string"==typeof s?e.json=JSON.parse(s):s instanceof ArrayBuffer?(r=K(e,s,r,i),e.hasBinChunk&&e.buffers.push({arrayBuffer:s,byteOffset:e.binChunkByteOffset,byteLength:e.binChunkLength})):e.json=s,i.uri&&(e.baseUri=i.uri),i.fetchLinkedResources){var o=!0,a=!1,u=void 0;try{for(var c,f=(e.json.buffers||[])[Symbol.iterator]();!(o=(c=f.next()).done);o=!0){if(c.value.uri)throw new Error("parseGLTFSync: Cannot decode uri buffers")}}catch(e){a=!0,u=e}finally{try{o||null==f.return||f.return()}finally{if(a)throw u}}}return function(e,t){for(var r in n){var i=r in t&&!t[r];if(!i){var s=n[r];s.decode(e,t)}}}(e,i),r}function ce(e,t){return fe.apply(this,arguments)}function fe(){return(fe=h(u.a.mark(function e(t,r){var n,i,s=arguments;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>2&&void 0!==s[2]?s[2]:0,i=s.length>3&&void 0!==s[3]?s[3]:{},i=Object.assign({},ae,i),ue(t,r,n,se({},i,{fetchLinkedResources:!1,postProcess:!1,decompress:!1})),!i.fetchLinkedResources){e.next=7;break}return e.next=7,he(t,i);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function he(e,t){return le.apply(this,arguments)}function le(){return(le=h(u.a.mark(function e(t,r){var n,i,s,o,a,c,f,h,l,E;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=!0,i=!1,s=void 0,e.prev=3,o=t.json.buffers[Symbol.iterator]();case 5:if(n=(a=o.next()).done){e.next=22;break}if(!(c=a.value).uri){e.next=19;break}return N(f=r.fetch||window.fetch),h=U(c.uri,r.uri),e.next=13,f(h);case 13:return l=e.sent,e.next=16,l.arrayBuffer();case 16:E=e.sent,c.data=E,delete c.uri;case 19:n=!0,e.next=5;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(3),i=!0,s=e.t0;case 28:e.prev=28,e.prev=29,n||null==o.return||o.return();case 31:if(e.prev=31,!i){e.next=34;break}throw s;case 34:return e.finish(31);case 35:return e.finish(28);case 36:case"end":return e.stop()}},e,null,[[3,24,28,36],[29,,31,35]])}))).apply(this,arguments)}!function(){function e(){A(this,e)}d(e,[{key:"log",value:function(){}},{key:"info",value:function(){}},{key:"warn",value:function(){}},{key:"error",value:function(){}}])}();new Map;function Ee(e){this.wrapped=e}function _e(e){var t,r;function n(t,r){try{var s=e[t](r),o=s.value,a=o instanceof Ee;Promise.resolve(a?o.wrapped:o).then(function(e){a?n("next",e):i(s.done?"return":"normal",e)},function(e){n("throw",e)})}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,i){return new Promise(function(s,o){var a={key:e,arg:i,resolve:s,reject:o,next:null};r?r=r.next=a:(t=r=a,n(e,i))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(_e.prototype[Symbol.asyncIterator]=function(){return this}),_e.prototype.next=function(e){return this._invoke("next",e)},_e.prototype.throw=function(e){return this._invoke("throw",e)},_e.prototype.return=function(e){return this._invoke("return",e)};var Te=r(4);Te.a.TextEncoder;var ve=Te.a.TextDecoder;function Ae(e,t){return function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var s=t;var o=function(e,t){var r=function(e){if("string"==typeof e){if(0===e.indexOf("##/"))return e.slice(1);var t=e.match(/#\/([a-z]+)\/([0-9]+)/);if(t){var r=parseInt(t[2],10);return[t[1],r]}if(t=e.match(/\$\$\$([0-9]+)/)){var n=parseInt(t[1],10);return["accessors",n]}}return null}(e);if(r){var n=Y(r,2),i=n[0],s=n[1],o=t[i]&&t[i][s];if(o)return o;console.error("Invalid JSON pointer ".concat(e,": #/").concat(i,"/").concat(s))}return null}(s,n);if(o)return o;if(Array.isArray(s))return s.map(function(t){return e(t,r,n,i)});if(null!==s&&"object"===Object(l.a)(s)){var a={};for(var u in s)a[u]=e(s[u],r,n,i);return a}return s}(e,e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}function Re(e,t,r){r&&(e=function(e,t){for(var r=e.byteLength-t,n=new ArrayBuffer(r),i=new Uint8Array(e),s=new Uint8Array(n),o=0;o<r;o++)s[o]=i[t+o];return n}(e,r));for(var n=t.bufferViews||[],i=0;i<n.length;++i){N(n[i].byteLength>=0)}return{accessors:de(e,n,t),images:ye(e,n,t)}}function de(e,t,r){for(var n=r.accessors||[],i=[],s=0;s<n.length;++s){var o=n[s];N(o);var a=t[o.bufferView];if(a){var u=B(o,a),c=u.ArrayType,f=u.length,h=new c(e,a.byteOffset,f);h.accessor=o,i.push(h)}}return i}function ye(e,t,r){for(var n=r.images||[],i=[],s=0;s<n.length;++s){var o=n[s];N(o);var a=t[o.bufferView];N(a);var u=new Uint8Array(e,a.byteOffset,a.byteLength);u.imate=o,i.push(u)}return i}var ge,pe=function(){function e(){A(this,e)}return d(e,[{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.parseSync(e,t)}},{key:"parseSync",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.glbArrayBuffer=e,this.binaryByteOffset=null,this.packedJson=null,this.json=null,null===this.json&&null===this.binaryByteOffset){K(this,this.glbArrayBuffer,0,t),this.binaryByteOffset=this.binChunkByteOffset,this.packedJson=this.json;var r=Re(this.glbArrayBuffer,this.json,this.binaryByteOffset);this.json=Ae(this.json,r),this.unpackedBuffers=r}return this}},{key:"getApplicationData",value:function(e){return this.json[e]}},{key:"getJSON",value:function(){return this.json}},{key:"getArrayBuffer",value:function(){return this.glbArrayBuffer}},{key:"getBinaryByteOffset",value:function(){return this.binaryByteOffset}},{key:"getBufferView",value:function(e){var t=(e.byteOffset||0)+this.binaryByteOffset;return new Uint8Array(this.glbArrayBuffer,t,e.byteLength)}},{key:"getBuffer",value:function(e){var t=F[e.componentType],r=I[e.type],n=L[e.componentType],i=e.count*r,s=e.count*r*n,o=this.json.bufferViews[e.bufferView];N(s>=0&&e.byteOffset+s<=o.byteLength);var a=o.byteOffset+this.binaryByteOffset+e.byteOffset;return new t(this.glbArrayBuffer,a,i)}},{key:"getImageData",value:function(e){return{typedArray:this.getBufferView(e.bufferView),mimeType:e.mimeType||"image/jpeg"}}},{key:"getImage",value:function(e){var t=this.getBufferView(e.bufferView),r=e.mimeType||"image/jpeg",n=new Blob([t],{type:r}),i=(self.URL||self.webkitURL).createObjectURL(n),s=new Image;return s.src=i,s}},{key:"getImageAsync",value:function(e){var t=this;return new Promise(function(r){var n=t.getBufferView(e.bufferView),i=e.mimeType||"image/jpeg",s=new Blob([n],{type:i}),o=(self.URL||self.webkitURL).createObjectURL(s),a=new Image;a.onload=function(){return r(a)},a.src=o})}}],[{key:"isGLB",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return W(e,0)}}]),e}(),me={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Se={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Ne={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Me={magFilter:Ne.TEXTURE_MAG_FILTER,minFilter:Ne.TEXTURE_MIN_FILTER,wrapS:Ne.TEXTURE_WRAP_S,wrapT:Ne.TEXTURE_WRAP_T},Oe=(c(ge={},Ne.TEXTURE_MAG_FILTER,Ne.LINEAR),c(ge,Ne.TEXTURE_MIN_FILTER,Ne.NEAREST_MIPMAP_LINEAR),c(ge,Ne.TEXTURE_WRAP_S,Ne.REPEAT),c(ge,Ne.TEXTURE_WRAP_,Ne.REPEAT),ge);var Ie=function(){function e(){A(this,e)}return d(e,[{key:"postProcess",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.gltf=e,this.glbParser=t,this._resolveToTree(r),this.gltf}},{key:"_resolveToTree",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.gltf;return(r.bufferViews||[]).forEach(function(t,r){return e._resolveBufferView(t,r)}),(r.images||[]).forEach(function(r,n){return e._resolveImage(r,n,t)}),(r.samplers||[]).forEach(function(t,r){return e._resolveSampler(t,r)}),(r.textures||[]).forEach(function(t,r){return e._resolveTexture(t,r)}),(r.accessors||[]).forEach(function(t,r){return e._resolveAccessor(t,r)}),(r.materials||[]).forEach(function(t,r){return e._resolveMaterial(t,r)}),(r.meshes||[]).forEach(function(t,r){return e._resolveMesh(t,r)}),(r.nodes||[]).forEach(function(t,r){return e._resolveNode(t,r)}),(r.skins||[]).forEach(function(t,r){return e._resolveSkin(t,r)}),(r.scenes||[]).forEach(function(t,r){return e._resolveScene(t,r)}),void 0!==r.scene&&(r.scene=r.scenes[this.gltf.scene]),this._process_extension_KHR_lights_punctual(),r}},{key:"getScene",value:function(e){return this._get("scenes",e)}},{key:"getNode",value:function(e){return this._get("nodes",e)}},{key:"getSkin",value:function(e){return this._get("skins",e)}},{key:"getMesh",value:function(e){return this._get("meshes",e)}},{key:"getMaterial",value:function(e){return this._get("materials",e)}},{key:"getAccessor",value:function(e){return this._get("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this._get("textures",e)}},{key:"getSampler",value:function(e){return this._get("samplers",e)}},{key:"getImage",value:function(e){return this._get("images",e)}},{key:"getBufferView",value:function(e){return this._get("bufferViews",e)}},{key:"getBuffer",value:function(e){return this._get("buffers",e)}},{key:"_get",value:function(e,t){if("object"===Object(l.a)(t))return t;var r=this.gltf[e]&&this.gltf[e][t];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),r}},{key:"_resolveScene",value:function(e,t){var r=this;e.id="scene-".concat(t),e.nodes=(e.nodes||[]).map(function(e){return r.getNode(e)})}},{key:"_resolveNode",value:function(e,t){var r=this;e.id="node-".concat(t),e.children=(e.children||[]).map(function(e){return r.getNode(e)}),void 0!==e.mesh&&(e.mesh=this.getMesh(e.mesh)),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin))}},{key:"_resolveSkin",value:function(e,t){e.id="skin-".concat(t),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices)}},{key:"_resolveMesh",value:function(e,t){e.id="mesh-".concat(t);var r=!0,n=!1,i=void 0;try{for(var s,o=e.primitives[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var a=s.value;for(var u in a.attributes)a.attributes[u]=this.getAccessor(a.attributes[u]);void 0!==a.indices&&(a.indices=this.getAccessor(a.indices)),void 0!==a.material&&(a.material=this.getMaterial(a.material))}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"_resolveMaterial",value:function(e,t){if(e.id="material-".concat(t),e.normalTexture&&(e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.pbrMetallicRoughness){var r=e.pbrMetallicRoughness;r.baseColorTexture&&(r.baseColorTexture.texture=this.getTexture(r.baseColorTexture.index)),r.metallicRoughnessTexture&&(r.metallicRoughnessTexture.texture=this.getTexture(r.metallicRoughnessTexture.index))}}},{key:"_resolveAccessor",value:function(e,t){e.id="accessor-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=Se[e],e.components=me[e],e.bytesPerElement=e.bytesPerComponent*e.components}},{key:"_resolveTexture",value:function(e,t){e.id="texture-".concat(t),e.sampler="sampler"in e?this.getSampler(e.sampler):Oe,e.source=this.getImage(e.source)}},{key:"_resolveSampler",value:function(e,t){for(var r in e.id="sampler-".concat(t),e.parameters={},e){var n=this._enumSamplerParameter(r);void 0!==n&&(e.parameters[n]=e[r])}}},{key:"_enumSamplerParameter",value:function(e){return Me[e]}},{key:"_resolveImage",value:function(e,t,r){var n=this;e.id="image-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));var i=r.createImages;void 0===i||i?e.image=this.glbParser.getImage(e):e.getImageAsync=function(){return n.glbParser?n.glbParser.getImageAsync(e):e.uri?new Promise(function(t){var n=new Image;n.crossOrigin="anonymous",n.onload=function(){return t(n)},n.src=U(e.uri,r.uri)}):null}}},{key:"_resolveBufferView",value:function(e,t){if(e.id="bufferView-".concat(t),e.buffer=this.getBuffer(e.buffer),this.glbParser)e.data=this.glbParser.getBufferView(e);else{var r=e.byteOffset||0;e.data=new Uint8Array(e.buffer.data,r,e.byteLength)}}},{key:"_resolveCamera",value:function(e){e.perspective,e.orthographic}},{key:"_process_extension_KHR_lights_punctual",value:function(){var e=this.gltf,t=e.extensions&&e.extensions.KHR_lights_punctual;t&&(e.lights=t.lights),this._removeExtension("KHR_lights_punctual");var r=!0,n=!1,i=void 0;try{for(var s,o=(e.nodes||[])[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var a=s.value,u=a.extensions&&a.extensions.KHR_lights_punctual;u&&(a.light=this._get("lights",u.light),delete a.extensions.KHR_lights_punctual)}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}delete e.lights}},{key:"_removeExtension",value:function(e){this.gltf.extensionsRequired&&this._removeStringFromArray(this.gltf.extensionsRequired,e),this.gltf.extensionsUsed&&this._removeStringFromArray(this.gltf.extensionsUsed,e),this.gltf.extensions&&delete this.gltf.extensions[e]}},{key:"_removeStringFromArray",value:function(e,t){for(var r=!0;r;){var n=e.indexOf(t);n>-1?e.splice(n,1):r=!1}}}]),e}();function Le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Fe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Le(r,!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Le(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Ce={fetchLinkedResources:!0,fetch:m,decompress:!1,DracoLoader:null,postProcess:!0,createImages:!1,log:console},be=function(){function e(){A(this,e)}return d(e,[{key:"parse",value:function(){var e=h(u.a.mark(function e(t){var r,n=arguments;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.length>1&&void 0!==n[1]?n[1]:{},r=Object.assign({},Ce,r),this.parseSync(t,Fe({},r,{postProcess:!1,decompress:!1})),!r.fetchLinkedResources){e.next=6;break}return e.next=6,this._loadLinkedAssets(r);case 6:return r.decompress&&this._decompressMeshes(r),r.postProcess&&(new Ie).postProcess(this.gltf,this.glbParser,r),e.abrupt("return",this.gltf);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"parseSync",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(t=Object.assign({},Ce,t),e instanceof ArrayBuffer&&!pe.isGLB(e,t))&&(e=(new ve).decode(e));("string"==typeof e&&(e=JSON.parse(e)),e instanceof ArrayBuffer?(this.glbParser=new pe,this.gltf=this.glbParser.parseSync(e).json,this.json=this.gltf):(this.glbParser=null,this.gltf=e,this.json=e),t.decompress&&this._decompressMeshes(t),t.postProcess)&&(new Ie).postProcess(this.gltf,this.glbParser,t);return this.gltf}},{key:"getApplicationData",value:function(e){return this.json[e]}},{key:"getExtraData",value:function(e){return(this.json.extras||{})[e]}},{key:"getExtension",value:function(e){var t=this.getUsedExtensions().find(function(t){return t===e}),r=this.json.extensions||{};return t?r[e]||!0:null}},{key:"getRequiredExtension",value:function(e){return this.getRequiredExtensions().find(function(t){return t===e})?this.getExtension(e):null}},{key:"getRequiredExtensions",value:function(){return this.json.extensionsRequired||[]}},{key:"getUsedExtensions",value:function(){return this.json.extensionsUsed||[]}},{key:"getScene",value:function(e){return this._get("scenes",e)}},{key:"getNode",value:function(e){return this._get("nodes",e)}},{key:"getSkin",value:function(e){return this._get("skins",e)}},{key:"getMesh",value:function(e){return this._get("meshes",e)}},{key:"getMaterial",value:function(e){return this._get("materials",e)}},{key:"getAccessor",value:function(e){return this._get("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this._get("textures",e)}},{key:"getSampler",value:function(e){return this._get("samplers",e)}},{key:"getImage",value:function(e){return this._get("images",e)}},{key:"getBufferView",value:function(e){return this._get("bufferViews",e)}},{key:"getBuffer",value:function(e){return this._get("buffers",e)}},{key:"_get",value:function(e,t){if("object"===Object(l.a)(t))return t;var r=this.gltf[e]&&this.gltf[e][t];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),r}},{key:"_loadLinkedAssets",value:function(){var e=h(u.a.mark(function e(t){var r=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.gltf.buffers.map(function(e){return r._loadBuffer(e,t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_loadBuffer",value:function(){var e=h(u.a.mark(function e(t,r){var n,i,s,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.uri){e.next=11;break}return n=r.fetch||window.fetch,i=U(t.uri,r.uri),e.next=5,n(i);case 5:return s=e.sent,e.next=8,s.arrayBuffer();case 8:o=e.sent,t.data=o,t.uri=null;case 11:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"_decompressMeshes",value:function(e){if(e.DracoLoader&&e.decompress){var t=!0,r=!1,n=void 0;try{for(var i,s=(this.gltf.meshes||[])[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value,a=!0,u=!1,c=void 0;try{for(var f,h=o.primitives[Symbol.iterator]();!(a=(f=h.next()).done);a=!0){var l=f.value;if(this._decompressKhronosDracoPrimitive(l,e),this._decompressUberDracoPrimitive(l,e),!l.attributes||0===Object.keys(l.attributes).length)throw new Error("Empty glTF primitive: decompression failure?")}}catch(e){u=!0,c=e}finally{try{a||null==h.return||h.return()}finally{if(u)throw c}}}}catch(e){r=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw n}}this._removeExtension("KHR_draco_mesh_compression"),this._removeExtension("UBER_draco_point_cloud_compression")}}},{key:"_decompressKhronosDracoPrimitive",value:function(e,t){var r=e.extensions&&e.extensions.KHR_draco_mesh_compression;if(r){delete e.extensions.KHR_draco_mesh_compression;var n=this._getBufferViewArray(r.bufferView),i=t.DracoLoader.parseSync(n);e.attributes=ee(i.attributes),i.indices&&(e.indices=te(i.indices))}}},{key:"_decompressUberDracoPrimitive",value:function(e,t){var r=e.extensions&&e.extensions.UBER_draco_point_cloud_compression;if(r){if(0!==e.mode)throw new Error("UBER_draco_point_cloud_compression");delete e.extensions.UBER_draco_point_cloud_compression;var n=this._getBufferViewArray(r.bufferView),i=t.DracoLoader.parseSync(n);e.attributes=i.attributes}}},{key:"_getBufferViewArray",value:function(e){var t=this.gltf.bufferViews[e];if(this.glbParser)return this.glbParser.getBufferView(t);var r=this.gltf.buffers[t.buffer].data,n=t.byteOffset||0;return new Uint8Array(r,n,t.byteLength)}},{key:"_removeExtension",value:function(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}},{key:"_removeStringFromArray",value:function(e,t){for(var r=!0;r;){var n=e.indexOf(t);n>-1?e.splice(n,1):r=!1}}}]),e}();function Be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Be(r,!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Be(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Pe={useGLTFParser:!0};function we(){return(we=h(u.a.mark(function e(t){var r,n,i,s,o,a=arguments;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>1&&void 0!==a[1]?a[1]:{},!(r=Ue({},Pe,{},r)).useGLTFParser){e.next=5;break}return n=new be,e.abrupt("return",n.parse(t,r));case 5:return i=r.byteOffset,s=void 0===i?0:i,o={},e.next=9,ce(o,t,s,r);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ke={name:"glTF",extensions:["gltf","glb"],text:!0,binary:!0,test:"glTF",parse:function(e){return we.apply(this,arguments)},parseSync:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((t=Ue({},Pe,{},t)).useGLTFParser)return(new be).parseSync(e,t);var r=t.byteOffset,n={};return ue(n,e,void 0===r?0:r,t),n},defaultOptions:Pe};function De(e,t){return!t||"object"!==Object(l.a)(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ge(e,t){return(Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ve(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ge(e,t)}function je(e,t,r){return(je=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&Ge(i,r.prototype),i}).apply(null,arguments)}function Xe(e){var t="function"==typeof Map?new Map:void 0;return(Xe=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return je(e,arguments,xe(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Ge(n,e)})(e)}var He={};function We(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(e));return e}function Ke(e){return Math.round(e/He.EPSILON)*He.EPSILON}function Ye(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).precision,r=void 0===t?He.precision||4:t;return e=Ke(e),parseFloat(e.toPrecision(r))}function qe(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&void 0!==e.length}function Ze(e,t){if(qe(e)&&qe(t)){if(e===t)return!0;if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!Ze(e[r],t[r]))return!1;return!0}return Math.abs(e-t)<=He.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}He.EPSILON=1e-12,He.debug=!0,He.precision=4,He.printTypes=!1,He.printDegrees=!1,He.printRowMajor=!0;var ze=function(e){function t(){return A(this,t),De(this,xe(t).apply(this,arguments))}return Ve(t,Xe(Array)),d(t,[{key:"clone",value:function(){return(new this.constructor).copy(this).check()}},{key:"copy",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=e[t];return this.check()}},{key:"set",value:function(){for(var e=0;e<this.ELEMENTS;++e)this[e]=(e<0||arguments.length<=e?void 0:arguments[e])||0;return this.check()}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)this[r]=e[r+t];return this.check()}},{key:"toString",value:function(){return this.formatString(He)}},{key:"formatString",value:function(e){for(var t="",r=0;r<this.ELEMENTS;++r)t+=(r>0?", ":"")+Ye(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)e[t+r]=this[r];return e}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"equals",value:function(e){if(!e||this.length!==e.length)return!1;for(var t=0;t<this.ELEMENTS;++t)if(!Ze(this[t],e[t]))return!1;return!0}},{key:"exactEquals",value:function(e){if(!e||this.length!==e.length)return!1;for(var t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}},{key:"negate",value:function(){for(var e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}},{key:"inverse",value:function(){for(var e=0;e<this.ELEMENTS;++e)this[e]=1/this[e];return this.check()}},{key:"lerp",value:function(e,t,r){void 0===r&&(r=t,t=e,e=this);for(var n=0;n<this.ELEMENTS;++n){var i=e[n];this[n]=i+r*(t[n]-i)}return this.check()}},{key:"min",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}},{key:"max",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}},{key:"clamp",value:function(e,t){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),t[r]);return this.check()}},{key:"validate",value:function(){for(var e=this.length===this.ELEMENTS,t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}},{key:"check",value:function(){if(He.debug&&!this.validate(this))throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"sub",value:function(e){return this.subtract(e)}},{key:"setScalar",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}},{key:"addScalar",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}},{key:"subScalar",value:function(e){return this.addScalar(-e)}},{key:"multiplyScalar",value:function(e){return this.scale(e)}},{key:"divideScalar",value:function(e){return this.scale(1/e)}},{key:"clampScalar",value:function(e,t){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),t);return this.check()}}]),t}();function Qe(e,t){return e.length===t&&e.every(Number.isFinite)}var $e=function(e,t){if(!e)throw new Error(t)},Je=function(e){function t(){return A(this,t),De(this,xe(t).apply(this,arguments))}return Ve(t,ze),d(t,[{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"lengthSquared",value:function(){for(var e=0,t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}},{key:"distance",value:function(e){return Math.sqrt(this.distanceSquared(e))}},{key:"distanceSquared",value:function(e){for(var t=0,r=0;r<this.ELEMENTS;++r){var n=this[r]-e[r];t+=n*n}return We(t)}},{key:"dot",value:function(e){for(var t=0,r=0;r<this.ELEMENTS;++r)t+=this[r]*e[r];return We(t)}},{key:"normalize",value:function(){var e=this.magnitude();if(0!==e)for(var t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0;n<t.length;n++)for(var i=t[n],s=0;s<this.ELEMENTS;++s)this[s]+=i[s];return this.check()}},{key:"subtract",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0;n<t.length;n++)for(var i=t[n],s=0;s<this.ELEMENTS;++s)this[s]-=i[s];return this.check()}},{key:"multiply",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0;n<t.length;n++)for(var i=t[n],s=0;s<this.ELEMENTS;++s)this[s]*=i[s];return this.check()}},{key:"divide",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0;n<t.length;n++)for(var i=t[n],s=0;s<this.ELEMENTS;++s)this[s]/=i[s];return this.check()}},{key:"scale",value:function(e){if(Array.isArray(e))return this.multiply(e);for(var t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}},{key:"scaleAndAdd",value:function(e,t){for(var r=0;r<this.ELEMENTS;++r)this[r]=this[r]*t+e[r];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(e){return this.distance(e)}},{key:"distanceToSquared",value:function(e){return this.distanceSquared(e)}},{key:"getComponent",value:function(e){return $e(e>=0&&e<this.ELEMENTS,"index is out of range"),We(this[e])}},{key:"setComponent",value:function(e,t){return $e(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}},{key:"addVectors",value:function(e,t){return this.copy(e).add(t)}},{key:"subVectors",value:function(e,t){return this.copy(e).subtract(t)}},{key:"multiplyVectors",value:function(e,t){return this.copy(e).multiply(t)}},{key:"addScaledVector",value:function(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}},{key:"x",get:function(){return this[0]},set:function(e){return this[0]=We(e)}},{key:"y",get:function(){return this[1]},set:function(e){return this[1]=We(e)}}]),t}(),et=1e-6,tt="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;rt=new tt(2),tt!=Float32Array&&(rt[0]=0,rt[1]=0),nt=rt;var rt,nt,it=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return A(this,t),e=De(this,xe(t).call(this,2)),Array.isArray(r)&&1===arguments.length?e.copy(r):e.set(r,n),e}return Ve(t,Je),d(t,[{key:"cross",value:function(e){return function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];e[0]=e[1]=0,e[2]=n}(this,this,e),this.check()}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"operation",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.apply(void 0,[this,this].concat(r)),this.check()}},{key:"ELEMENTS",get:function(){return 2}}]),t}();function st(){var e=new tt(3);return tt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ot(e,t,r){var n=new tt(3);return n[0]=e,n[1]=t,n[2]=r,n}function at(e,t){var r=t[0],n=t[1],i=t[2],s=r*r+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function ut(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ct(e,t,r){var n=t[0],i=t[1],s=t[2],o=r[0],a=r[1],u=r[2];return e[0]=i*u-s*a,e[1]=s*o-n*u,e[2]=n*a-i*o,e}var ft=function(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)},ht=(function(){var e=st()}(),[0,0,0]),lt=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return A(this,t),e=De(this,xe(t).call(this,3)),Array.isArray(r)&&1===arguments.length?e.copy(r):e.set(r,n,i),e}return Ve(t,Je),d(t,[{key:"angle",value:function(e){return function(e,t){var r=ot(e[0],e[1],e[2]),n=ot(t[0],t[1],t[2]);at(r,r),at(n,n);var i=ut(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)}(this,e)}},{key:"cross",value:function(e){return ct(this,this,e),this.check()}},{key:"rotateX",value:function(e){var t=e.radians,r=e.origin;return function(e,t,r,n){var i=[],s=[];i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2]}(this,this,void 0===r?ht:r,t),this.check()}},{key:"rotateY",value:function(e){var t=e.radians,r=e.origin;return function(e,t,r,n){var i=[],s=[];i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2]}(this,this,void 0===r?ht:r,t),this.check()}},{key:"rotateZ",value:function(e){var t=e.radians,r=e.origin;return function(e,t,r,n){var i=[],s=[];i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2]}(this,this,void 0===r?ht:r,t),this.check()}},{key:"operation",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.apply(void 0,[this,this].concat(r)),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(e){return this[2]=We(e)}}]),t}(),Et=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return A(this,t),e=De(this,xe(t).call(this,4)),Array.isArray(r)&&1===arguments.length?e.copy(r):e.set(r,n,i,s),e}return Ve(t,Je),d(t,[{key:"applyMatrix4",value:function(e){return e.transformVector(this,this),this}},{key:"ELEMENTS",get:function(){return 4}},{key:"z",get:function(){return this[2]},set:function(e){return this[2]=We(e)}},{key:"w",get:function(){return this[3]},set:function(e){return this[3]=We(e)}}]),t}();function _t(e,t,r){var n=t[0],i=t[1],s=t[2],o=t[3],a=t[4],u=t[5],c=t[6],f=t[7],h=t[8],l=t[9],E=t[10],_=t[11],T=t[12],v=t[13],A=t[14],R=t[15],d=r[0],y=r[1],g=r[2],p=r[3];return e[0]=d*n+y*a+g*h+p*T,e[1]=d*i+y*u+g*l+p*v,e[2]=d*s+y*c+g*E+p*A,e[3]=d*o+y*f+g*_+p*R,d=r[4],y=r[5],g=r[6],p=r[7],e[4]=d*n+y*a+g*h+p*T,e[5]=d*i+y*u+g*l+p*v,e[6]=d*s+y*c+g*E+p*A,e[7]=d*o+y*f+g*_+p*R,d=r[8],y=r[9],g=r[10],p=r[11],e[8]=d*n+y*a+g*h+p*T,e[9]=d*i+y*u+g*l+p*v,e[10]=d*s+y*c+g*E+p*A,e[11]=d*o+y*f+g*_+p*R,d=r[12],y=r[13],g=r[14],p=r[15],e[12]=d*n+y*a+g*h+p*T,e[13]=d*i+y*u+g*l+p*v,e[14]=d*s+y*c+g*E+p*A,e[15]=d*o+y*f+g*_+p*R,e}function Tt(e,t,r){var n=r[0],i=r[1],s=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function vt(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function At(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function Rt(e,t,r){var n=t[0],i=t[1],s=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*s+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*s+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*s+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*s+r[15]*o,e}!function(){var e=function(){var e=new tt(4);return tt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}();var dt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var yt=function(e){function t(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return A(this,t),e=De(this,xe(t).call(this,16)),Array.isArray(n[0])&&1===arguments.length?e.copy(n[0]):e.identity(),e}return Ve(t,ze),d(t,[{key:"setRowMajor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,h=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,l=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,E=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,_=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,T=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=e,this[1]=i,this[2]=u,this[3]=l,this[4]=t,this[5]=s,this[6]=c,this[7]=E,this[8]=r,this[9]=o,this[10]=f,this[11]=_,this[12]=n,this[13]=a,this[14]=h,this[15]=T,this.check()}},{key:"setColumnMajor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,h=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,l=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,E=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,_=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,T=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=e,this[1]=t,this[2]=r,this[3]=n,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=u,this[9]=c,this[10]=f,this[11]=h,this[12]=l,this[13]=E,this[14]=_,this[15]=T,this.check()}},{key:"set",value:function(){return this.setColumnMajor.apply(this,arguments)}},{key:"getElement",value:function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this[e][t]:this[t][e]}},{key:"setElement",value:function(e,t,r){return arguments.length>3&&void 0!==arguments[3]&&arguments[3]?this[e][t]=We(r):this[t][e]=We(r),this}},{key:"determinant",value:function(){return t=(e=this)[0],r=e[1],n=e[2],i=e[3],s=e[4],o=e[5],a=e[6],u=e[7],c=e[8],f=e[9],h=e[10],l=e[11],E=e[12],_=e[13],T=e[14],v=e[15],(t*o-r*s)*(h*v-l*T)-(t*a-n*s)*(f*v-l*_)+(t*u-i*s)*(f*T-h*_)+(r*a-n*o)*(c*v-l*E)-(r*u-i*o)*(c*T-h*E)+(n*u-i*a)*(c*_-f*E);var e,t,r,n,i,s,o,a,u,c,f,h,l,E,_,T,v}},{key:"identity",value:function(){return this.copy(dt)}},{key:"fromQuaternion",value:function(e){return function(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],o=r+r,a=n+n,u=i+i,c=r*o,f=n*o,h=n*a,l=i*o,E=i*a,_=i*u,T=s*o,v=s*a,A=s*u;e[0]=1-h-_,e[1]=f+A,e[2]=l-v,e[3]=0,e[4]=f-A,e[5]=1-c-_,e[6]=E+T,e[7]=0,e[8]=l+v,e[9]=E-T,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(this,e),this.check()}},{key:"frustum",value:function(e){return function(e,t,r,n,i,s,o){var a=1/(r-t),u=1/(i-n),c=1/(s-o);e[0]=2*s*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*u,e[6]=0,e[7]=0,e[8]=(r+t)*a,e[9]=(i+n)*u,e[10]=(o+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*s*2*c,e[15]=0}(this,e.left,e.right,e.bottom,e.top,e.near,e.far),this.check()}},{key:"lookAt",value:function(e){var t=e.eye,r=e.center,n=void 0===r?[0,0,0]:r,i=e.up;return function(e,t,r,n){var i,s,o,a,u,c,f,h,l,E,_=t[0],T=t[1],v=t[2],A=n[0],R=n[1],d=n[2],y=r[0],g=r[1],p=r[2];Math.abs(_-y)<et&&Math.abs(T-g)<et&&Math.abs(v-p)<et?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(e):(f=_-y,h=T-g,l=v-p,i=R*(l*=E=1/Math.sqrt(f*f+h*h+l*l))-d*(h*=E),s=d*(f*=E)-A*l,o=A*h-R*f,(E=Math.sqrt(i*i+s*s+o*o))?(i*=E=1/E,s*=E,o*=E):(i=0,s=0,o=0),a=h*o-l*s,u=l*i-f*o,c=f*s-h*i,(E=Math.sqrt(a*a+u*u+c*c))?(a*=E=1/E,u*=E,c*=E):(a=0,u=0,c=0),e[0]=i,e[1]=a,e[2]=f,e[3]=0,e[4]=s,e[5]=u,e[6]=h,e[7]=0,e[8]=o,e[9]=c,e[10]=l,e[11]=0,e[12]=-(i*_+s*T+o*v),e[13]=-(a*_+u*T+c*v),e[14]=-(f*_+h*T+l*v),e[15]=1)}(this,t,n,void 0===i?[0,1,0]:i),this.check()}},{key:"ortho",value:function(e){var t=e.left,r=e.right,n=e.bottom,i=e.top,s=e.near,o=void 0===s?.1:s,a=e.far;return function(e,t,r,n,i,s,o){var a=1/(t-r),u=1/(n-i),c=1/(s-o);e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*a,e[13]=(i+n)*u,e[14]=(o+s)*c,e[15]=1}(this,t,r,n,i,o,void 0===a?500:a),this.check()}},{key:"orthographic",value:function(e){var r=e.fovy,n=void 0===r?45*Math.PI/180:r,i=e.aspect,s=void 0===i?1:i,o=e.focalDistance,a=void 0===o?1:o,u=e.near,c=void 0===u?.1:u,f=e.far,h=void 0===f?500:f;if(n>2*Math.PI)throw Error("radians");var l=n/2,E=a*Math.tan(l),_=E*s;return(new t).ortho({left:-_,right:_,bottom:-E,top:E,near:c,far:h})}},{key:"perspective",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fovy,r=e.fov,n=void 0===r?45*Math.PI/180:r,i=e.aspect,s=void 0===i?1:i,o=e.near,a=void 0===o?.1:o,u=e.far,c=void 0===u?500:u;if((t=t||n)>2*Math.PI)throw Error("radians");return function(e,t,r,n,i){var s,o=1/Math.tan(t/2);e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(s=1/(n-i),e[10]=(i+n)*s,e[14]=2*i*n*s):(e[10]=-1,e[14]=-2*n)}(this,t,s,a,c),this.check()}},{key:"transpose",value:function(){return function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],s=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=s,e[11]=t[14],e[12]=i,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]}(this,this),this.check()}},{key:"invert",value:function(){return function(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],o=t[4],a=t[5],u=t[6],c=t[7],f=t[8],h=t[9],l=t[10],E=t[11],_=t[12],T=t[13],v=t[14],A=t[15],R=r*a-n*o,d=r*u-i*o,y=r*c-s*o,g=n*u-i*a,p=n*c-s*a,m=i*c-s*u,S=f*T-h*_,N=f*v-l*_,M=f*A-E*_,O=h*v-l*T,I=h*A-E*T,L=l*A-E*v,F=R*L-d*I+y*O+g*M-p*N+m*S;F&&(F=1/F,e[0]=(a*L-u*I+c*O)*F,e[1]=(i*I-n*L-s*O)*F,e[2]=(T*m-v*p+A*g)*F,e[3]=(l*p-h*m-E*g)*F,e[4]=(u*M-o*L-c*N)*F,e[5]=(r*L-i*M+s*N)*F,e[6]=(v*y-_*m-A*d)*F,e[7]=(f*m-l*y+E*d)*F,e[8]=(o*I-a*M+c*S)*F,e[9]=(n*M-r*I-s*S)*F,e[10]=(_*p-T*y+A*R)*F,e[11]=(h*y-f*p-E*R)*F,e[12]=(a*N-o*O-u*S)*F,e[13]=(r*O-n*N+i*S)*F,e[14]=(T*d-_*g-v*R)*F,e[15]=(f*g-h*d+l*R)*F)}(this,this),this.check()}},{key:"multiplyLeft",value:function(e){return _t(this,e,this),this.check()}},{key:"multiplyRight",value:function(e){return _t(this,this,e),this.check()}},{key:"rotateX",value:function(e){return function(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[4],o=t[5],a=t[6],u=t[7],c=t[8],f=t[9],h=t[10],l=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+c*n,e[5]=o*i+f*n,e[6]=a*i+h*n,e[7]=u*i+l*n,e[8]=c*i-s*n,e[9]=f*i-o*n,e[10]=h*i-a*n,e[11]=l*i-u*n}(this,this,e),this.check()}},{key:"rotateY",value:function(e){return function(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[0],o=t[1],a=t[2],u=t[3],c=t[8],f=t[9],h=t[10],l=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-c*n,e[1]=o*i-f*n,e[2]=a*i-h*n,e[3]=u*i-l*n,e[8]=s*n+c*i,e[9]=o*n+f*i,e[10]=a*n+h*i,e[11]=u*n+l*i}(this,this,e),this.check()}},{key:"rotateZ",value:function(e){return function(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[0],o=t[1],a=t[2],u=t[3],c=t[4],f=t[5],h=t[6],l=t[7];t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+c*n,e[1]=o*i+f*n,e[2]=a*i+h*n,e[3]=u*i+l*n,e[4]=c*i-s*n,e[5]=f*i-o*n,e[6]=h*i-a*n,e[7]=l*i-u*n}(this,this,e),this.check()}},{key:"rotateXYZ",value:function(e){var t=Y(e,3),r=t[0],n=t[1],i=t[2];return this.rotateX(r).rotateY(n).rotateZ(i)}},{key:"rotateAxis",value:function(e,t){return function(e,t,r,n){var i,s,o,a,u,c,f,h,l,E,_,T,v,A,R,d,y,g,p,m,S,N,M,O,I=n[0],L=n[1],F=n[2],C=Math.sqrt(I*I+L*L+F*F);C<et||(I*=C=1/C,L*=C,F*=C,i=Math.sin(r),o=1-(s=Math.cos(r)),a=t[0],u=t[1],c=t[2],f=t[3],h=t[4],l=t[5],E=t[6],_=t[7],T=t[8],v=t[9],A=t[10],R=t[11],d=I*I*o+s,y=L*I*o+F*i,g=F*I*o-L*i,p=I*L*o-F*i,m=L*L*o+s,S=F*L*o+I*i,N=I*F*o+L*i,M=L*F*o-I*i,O=F*F*o+s,e[0]=a*d+h*y+T*g,e[1]=u*d+l*y+v*g,e[2]=c*d+E*y+A*g,e[3]=f*d+_*y+R*g,e[4]=a*p+h*m+T*S,e[5]=u*p+l*m+v*S,e[6]=c*p+E*m+A*S,e[7]=f*p+_*m+R*S,e[8]=a*N+h*M+T*O,e[9]=u*N+l*M+v*O,e[10]=c*N+E*M+A*O,e[11]=f*N+_*M+R*O,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(this,this,e,t),this.check()}},{key:"scale",value:function(e){return Array.isArray(e)?Tt(this,this,e):Tt(this,this,[e,e,e]),this.check()}},{key:"translate",value:function(e){return function(e,t,r){var n,i,s,o,a,u,c,f,h,l,E,_,T=r[0],v=r[1],A=r[2];t===e?(e[12]=t[0]*T+t[4]*v+t[8]*A+t[12],e[13]=t[1]*T+t[5]*v+t[9]*A+t[13],e[14]=t[2]*T+t[6]*v+t[10]*A+t[14],e[15]=t[3]*T+t[7]*v+t[11]*A+t[15]):(n=t[0],i=t[1],s=t[2],o=t[3],a=t[4],u=t[5],c=t[6],f=t[7],h=t[8],l=t[9],E=t[10],_=t[11],e[0]=n,e[1]=i,e[2]=s,e[3]=o,e[4]=a,e[5]=u,e[6]=c,e[7]=f,e[8]=h,e[9]=l,e[10]=E,e[11]=_,e[12]=n*T+a*v+h*A+t[12],e[13]=i*T+u*v+l*A+t[13],e[14]=s*T+c*v+E*A+t[14],e[15]=o*T+f*v+_*A+t[15])}(this,this,e),this.check()}},{key:"transformVector2",value:function(e,t){return function(e,t,r){var n=t[0],i=t[1];e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13]}(t=t||new it,e,this),Qe(t,2),t}},{key:"transformVector3",value:function(e,t){return function(e,t,r){var n=t[0],i=t[1],s=t[2],o=r[3]*n+r[7]*i+r[11]*s+r[15];o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*s+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*s+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*s+r[14])/o}(t=t||new lt,e,this),Qe(t,3),t}},{key:"transformVector4",value:function(e,t){return Rt(t=t||new Et,e,this),Qe(t,4),t.check()}},{key:"transformVector",value:function(e,t){switch(e.length){case 2:return this.transformVector2(e,t);case 3:return this.transformVector3(e,t);case 4:return this.transformVector4(e,t);default:throw new Error("Illegal vector")}}},{key:"transformDirection",value:function(e,t){return this._transformVector(e,t,0)}},{key:"transformPoint",value:function(e,t){return this._transformVector(e,t,1)}},{key:"_transformVector",value:function(e,t,r){switch(e.length){case 2:Rt(t=t||new it,[e[0],e[1],0,r],this),t.length=2,Qe(t,2);break;case 3:Rt(t=t||new lt,[e[0],e[1],e[2],r],this),t.length=3,Qe(t,3);break;case 4:if(Boolean(r)!==Boolean(e[3]))throw new Error("math.gl: Matrix4.transformPoint - invalid vector");Rt(t=t||new Et,e,this),Qe(t,4);break;default:throw new Error("Illegal vector")}return t}},{key:"makeRotationX",value:function(e){return this.identity().rotateX(e)}},{key:"makeTranslation",value:function(e,t,r){return this.identity().translate([e,t,r])}},{key:"ELEMENTS",get:function(){return 16}}]),t}();function gt(){var e=new tt(4);return tt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function pt(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function mt(e,t,r){var n=t[0],i=t[1],s=t[2],o=t[3],a=r[0],u=r[1],c=r[2],f=r[3];return e[0]=n*f+o*a+i*c-s*u,e[1]=i*f+o*u+s*a-n*c,e[2]=s*f+o*c+n*u-i*a,e[3]=o*f-n*a-i*u-s*c,e}function St(e,t,r,n){var i,s,o,a,u,c=t[0],f=t[1],h=t[2],l=t[3],E=r[0],_=r[1],T=r[2],v=r[3];return(s=c*E+f*_+h*T+l*v)<0&&(s=-s,E=-E,_=-_,T=-T,v=-v),1-s>et?(i=Math.acos(s),o=Math.sin(i),a=Math.sin((1-n)*i)/o,u=Math.sin(n*i)/o):(a=1-n,u=n),e[0]=a*c+u*E,e[1]=a*f+u*_,e[2]=a*h+u*T,e[3]=a*l+u*v,e}function Nt(e,t){var r,n=t[0]+t[4]+t[8];if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var s=(i+1)%3,o=(i+2)%3;r=Math.sqrt(t[3*i+i]-t[3*s+s]-t[3*o+o]+1),e[i]=.5*r,r=.5/r,e[3]=(t[3*s+o]-t[3*o+s])*r,e[s]=(t[3*s+i]+t[3*i+s])*r,e[o]=(t[3*o+i]+t[3*i+o])*r}return e}var Mt,Ot,It,Lt,Ft,Ct,bt=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},Bt=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},Ut=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},Pt=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},wt=function(e,t,r,n){var i=t[0],s=t[1],o=t[2],a=t[3];return e[0]=i+n*(r[0]-i),e[1]=s+n*(r[1]-s),e[2]=o+n*(r[2]-o),e[3]=a+n*(r[3]-a),e},kt=vt,Dt=At,xt=function(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],o=r*r+n*n+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=s*o,e},Gt=(Mt=st(),Ot=ot(1,0,0),It=ot(0,1,0),function(e,t,r){var n=ut(t,r);return n<-.999999?(ct(Mt,Ot,t),ft(Mt)<1e-6&&ct(Mt,It,t),at(Mt,Mt),pt(e,Mt,Math.PI),e):n>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(ct(Mt,t,r),e[0]=Mt[0],e[1]=Mt[1],e[2]=Mt[2],e[3]=1+n,xt(e,e))}),Vt=(Lt=gt(),Ft=gt(),Ct=function(){var e=new tt(9);return tt!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}(),[0,0,0,1]);var jt=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return A(this,t),e=De(this,xe(t).call(this,4)),Array.isArray(r)&&1===arguments.length?e.copy(r):e.set(r,n,i,s),e}return Ve(t,ze),d(t,[{key:"fromMatrix3",value:function(e){return Nt(this,e),this.check()}},{key:"fromValues",value:function(e,t,r,n){return this.set(e,t,r,n)}},{key:"identity",value:function(){return function(e){e[0]=0,e[1]=0,e[2]=0,e[3]=1}(this),this.check()}},{key:"length",value:function(){return kt(this)}},{key:"squaredLength",value:function(e){return Dt(this)}},{key:"dot",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return Pt(this,e)}},{key:"rotationTo",value:function(e,t){return Gt(this,e,t),this.check()}},{key:"add",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return Bt(this,e),this.check()}},{key:"calculateW",value:function(){return function(e,t){var r=t[0],n=t[1],i=t[2];e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i))}(this,this),this.check()}},{key:"conjugate",value:function(){return function(e,t){e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3]}(this,this),this.check()}},{key:"invert",value:function(){return function(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],o=r*r+n*n+i*i+s*s,a=o?1/o:0;e[0]=-r*a,e[1]=-n*a,e[2]=-i*a,e[3]=s*a}(this,this),this.check()}},{key:"lerp",value:function(e,t,r){return wt(this,e,t,r),this.check()}},{key:"multiply",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.multiply only takes one argument");return mt(this,this,e),this.check()}},{key:"normalize",value:function(){return xt(this,this),this.check()}},{key:"rotateX",value:function(e){return function(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(r),u=Math.cos(r);e[0]=n*u+o*a,e[1]=i*u+s*a,e[2]=s*u-i*a,e[3]=o*u-n*a}(this,this,e),this.check()}},{key:"rotateY",value:function(e){return function(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(r),u=Math.cos(r);e[0]=n*u-s*a,e[1]=i*u+o*a,e[2]=s*u+n*a,e[3]=o*u-i*a}(this,this,e),this.check()}},{key:"rotateZ",value:function(e){return function(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(r),u=Math.cos(r);e[0]=n*u+i*a,e[1]=i*u-n*a,e[2]=s*u+o*a,e[3]=o*u-s*a}(this,this,e),this.check()}},{key:"scale",value:function(e){return Ut(this,this,e),this.check()}},{key:"set",value:function(e,t,r,n){return bt(this,e,t,r,n),this.check()}},{key:"setAxisAngle",value:function(e,t){return pt(this,e,t),this.check()}},{key:"slerp",value:function(e){var t=e.start;return St(this,void 0===t?Vt:t,e.target,e.ratio),this.check()}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(e){return this[0]=We(e)}},{key:"y",get:function(){return this[1]},set:function(e){return this[1]=We(e)}},{key:"z",get:function(){return this[2]},set:function(e){return this[2]=We(e)}},{key:"w",get:function(){return this[3]},set:function(e){return this[3]=We(e)}}]),t}();const Xt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ht={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Wt(e){if(!e._animation){const t=Ht[e.componentType],r=Xt[e.type],n=r*e.count,{buffer:i,byteOffset:s}=e.bufferView.data,o=new t(i,s+(e.byteOffset||0),n);if(1===r)e._animation=Array.from(o);else{const t=[];for(let e=0;e<o.length;e+=r)t.push(Array.from(o.slice(e,e+r)));e._animation=t}}return e._animation}const Kt=new yt;const Yt=new jt;function qt(e,{input:t,interpolation:r,output:n},s,o){const a=e%t[t.length-1],u=t.findIndex(e=>e>=a),c=Math.max(0,u-1);if(!Array.isArray(s[o]))switch(o){case"translation":s[o]=[0,0,0];break;case"rotation":s[o]=[0,0,0,1];break;case"scale":s[o]=[1,1,1];break;default:i.log.warn(`Bad animation path ${o}`)()}Object(i.assert)(s[o].length===n[c].length);const f=t[c],h=t[u];switch(r){case"STEP":!function(e,t,r){for(let n=0;n<r.length;n++)e[t][n]=r[n]}(s,o,n[c]);break;case"LINEAR":if(h>f){const e=(a-f)/(h-f);!function(e,t,r,n,i){if("rotation"===t){Yt.slerp({start:r,target:n,ratio:i});for(let r=0;r<Yt.length;r++)e[t][r]=Yt[r]}else for(let s=0;s<r.length;s++)e[t][s]=i*n[s]+(1-i)*r[s]}(s,o,n[c],n[u],e)}break;case"CUBICSPLINE":if(h>f){const e=(a-f)/(h-f),t=h-f;!function(e,t,{p0:r,outTangent0:n,inTangent1:i,p1:s,tDiff:o,ratio:a}){for(let u=0;u<e[t].length;u++){const c=n[u]*o,f=i[u]*o;e[t][u]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*r[u]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*s[u]+(Math.pow(a,3)-Math.pow(a,2))*f}}(s,o,{p0:n[3*c+1],outTangent0:n[3*c+2],inTangent1:n[3*u+0],p1:n[3*u+1],tDiff:t,ratio:e})}break;default:i.log.warn(`Interpolation ${r} not supported`)()}}class Zt{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,Object.assign(this,e)}animate(e){if(!this.playing)return;const t=(e/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:e,target:r,path:n})=>{qt(t,e,r,n),function(e,t){if(t.matrix.identity(),e.translation&&t.matrix.translate(e.translation),e.rotation){const r=Kt.fromQuaternion(e.rotation);t.matrix.multiplyRight(r)}e.scale&&t.matrix.scale(e.scale)}(r,r._node)})}}class zt{constructor(e){this.animations=e.animations.map((t,r)=>{const n=t.name||`Animation-${r}`,i=t.samplers.map(({input:t,interpolation:r="LINEAR",output:n})=>({input:Wt(e.accessors[t]),interpolation:r,output:Wt(e.accessors[n])})),s=t.channels.map(({sampler:t,target:r})=>({sampler:i[t],target:e.nodes[r.node],path:r.path}));return new Zt({name:n,channels:s})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class Qt{constructor(e,{attributes:t,material:r,pbrDebug:n,imageBasedLightingEnvironment:i,lights:s,useTangents:o}){this.gl=e,this.defines={USE_TEX_LOD:1,MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],i&&(this.uniforms.u_DiffuseEnvSampler=i.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=i.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=i.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),n&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(t.NORMAL,"HAS_NORMALS"),this.defineIfPresent(t.TANGENT&&o,"HAS_TANGENTS"),this.defineIfPresent(t.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(i,"USE_IBL"),this.defineIfPresent(s,"USE_LIGHTS"),this.defineIfPresent(n,"PBR_DEBUG"),r&&this.parseMaterial(r)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t,r=null){const n=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},s=new i.Texture2D(this.gl,{id:e.name||e.id,parameters:n,pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},data:e.texture.source.getImageAsync()});this.uniforms[t]=s,this.defineIfPresent(r,r),this.generatedTextures.push(s)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:r=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,r]}parseMaterial(e){if(e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(i.log.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}const $t="\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n",Jt="\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n";function er(e,t){return Object(i.isWebGL2)(e)?`#version 300 es\n${t}`:t}const tr={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},rr={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class nr{constructor(e,t={}){this.gl=e,this.options=Object.assign({},rr,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(e=>this.createScene(e))}createAnimator(){return Array.isArray(this.gltf.animations)?new zt(this.gltf):null}createScene(e){const t=(e.nodes||[]).map(e=>this.createNode(e));return new i.GroupNode({id:e.name||e.id,children:t})}createNode(e){if(!e._node){const t=(e.children||[]).map(e=>this.createNode(e));e.mesh&&t.push(this.createMesh(e.mesh));const r=new i.GroupNode({id:e.name||e.id,children:t});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const t=(new yt).fromQuaternion(e.rotation);r.matrix.multiplyRight(t)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const t=(e.primitives||[]).map((t,r)=>this.createPrimitive(t,r,e)),r=new i.GroupNode({id:e.name||e.id,children:t});e._mesh=r}return e._mesh}getVertexCount(e){i.log.warn("getVertexCount() not found")()}createPrimitive(e,t,r){return function(e,t){const{id:r,drawMode:n,vertexCount:s,attributes:o,modelOptions:a}=t,u=new Qt(e,t);i.log.info(4,"createGLTFModel defines: ",u.defines)();const c=[];c.push(...u.generatedTextures),c.push(...Object.values(o).map(e=>e.buffer));const f=new i.ModelNode(e,Object.assign({id:r,drawMode:n,vertexCount:s,modules:[i.pbr],defines:u.defines,parameters:u.parameters,vs:er(e,$t),fs:er(e,Jt),managedResources:c},a));return f.setProps({attributes:o}),f.setUniforms(u.uniforms),f}(this.gl,Object.assign({id:e.name||`${r.name||r.id}-primitive-${t}`,drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,t){const r={};return Object.keys(e).forEach(t=>{r[t]=this.createAccessor(e[t],this.createBuffer(e[t],this.gl.ARRAY_BUFFER))}),t&&(r.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),i.log.info(4,"glTF Attributes",{attributes:e,indices:t,generated:r})(),r}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:r}=e;return r.lumaBuffers||(r.lumaBuffers={}),r.lumaBuffers[t]||(r.lumaBuffers[t]=new i.Buffer(this.gl,{id:`from-${r.id}`,data:r.data||e.value,target:t})),r.lumaBuffers[t]}createAccessor(e,t){return new i._Accessor({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:tr[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function ir(e,t,r){const n=new nr(e,r);return{scenes:n.instantiate(t),animator:n.createAnimator()}}var sr={name:"GLTF Scenegraph Loader",extensions:["gltf","glb"],parse:async function(e,t,r,n){Object(i.assert)(t.gl);const s=await ke.parse(e,{...t,uri:r,decompress:!0}),o=ir(t.gl,s,t);return t.waitForFullLoad&&await async function(e){const t=[];return e.scenes.forEach(e=>{e.traverse(e=>{Object.values(e.model.program.uniforms).forEach(e=>{!1===e.loaded&&t.push(e)})})}),await async function(e){for(;e();)await new Promise(e=>window.requestAnimationFrame(e))}(()=>t.some(e=>!e.loaded))}(o),Object.assign({gltf:s},o)}},or=r(2),ar=r.n(or);class ur{constructor(e,{brdfLutUrl:t,getTexUrl:r}){this.gl=e,this.brdfLutUrl=t,this.getTexUrl=r}makeCube({id:e,getTextureForFace:t,parameters:r}){const n={};return i.TextureCube.FACES.forEach(e=>{n[e]=t(e)}),new i.TextureCube(this.gl,{id:e,mipmaps:!1,parameters:r,pixels:n})}getDiffuseEnvSampler(){return this._DiffuseEnvSampler||(this._DiffuseEnvSampler=this.makeCube({id:"DiffuseEnvSampler",getTextureForFace:e=>Object(i.loadImage)(this.getTexUrl("diffuse",e,0)),parameters:{[ar.a.TEXTURE_WRAP_S]:ar.a.CLAMP_TO_EDGE,[ar.a.TEXTURE_WRAP_T]:ar.a.CLAMP_TO_EDGE,[ar.a.TEXTURE_MIN_FILTER]:ar.a.LINEAR,[ar.a.TEXTURE_MAG_FILTER]:ar.a.LINEAR}})),this._DiffuseEnvSampler}getSpecularEnvSampler(){return this._SpecularEnvSampler||(this._SpecularEnvSampler=this.makeCube({id:"SpecularEnvSampler",getTextureForFace:e=>{const t=[];for(let r=0;r<=9;r++)t.push(Object(i.loadImage)(this.getTexUrl("specular",e,r)));return t},parameters:{[ar.a.TEXTURE_WRAP_S]:ar.a.CLAMP_TO_EDGE,[ar.a.TEXTURE_WRAP_T]:ar.a.CLAMP_TO_EDGE,[ar.a.TEXTURE_MIN_FILTER]:ar.a.LINEAR_MIPMAP_LINEAR,[ar.a.TEXTURE_MAG_FILTER]:ar.a.LINEAR}})),this._SpecularEnvSampler}getBrdfTexture(){return this._BrdfTexture||(this._BrdfTexture=new i.Texture2D(this.gl,{id:"brdfLUT",parameters:{[ar.a.TEXTURE_WRAP_S]:ar.a.CLAMP_TO_EDGE,[ar.a.TEXTURE_WRAP_T]:ar.a.CLAMP_TO_EDGE,[ar.a.TEXTURE_MIN_FILTER]:ar.a.LINEAR,[ar.a.TEXTURE_MAG_FILTER]:ar.a.LINEAR},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},data:Object(i.loadImage)(this.brdfLutUrl)})),this._BrdfTexture}delete(){this._DiffuseEnvSampler&&(this._DiffuseEnvSampler.delete(),this._DiffuseEnvSampler=null),this._SpecularEnvSampler&&(this._SpecularEnvSampler.delete(),this._SpecularEnvSampler=null),this._BrdfTexture&&(this._BrdfTexture.delete(),this._BrdfTexture=null)}}let cr=0,fr=0;class hr{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:r=Number.POSITIVE_INFINITY,rate:n=1,repeat:i=1}=e,s=cr++,o={time:0,delay:t,duration:r,rate:n,repeat:i};return this._setChannelTime(o,this.time),this.channels.set(s,o),s}removeChannel(e){this.channels.delete(e);for(const[t,r]of this.animations)r.channel===e&&this.detachAnimation(t)}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const e of t)this._setChannelTime(e,this.time);const r=this.animations.values();for(const e of r){const{animation:t,channel:r}=e;t.setTime(this.getTime(r))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const r=fr++;return this.animations.set(r,{animation:e,channel:t}),e.setTime(this.getTime(t)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const r=t-e.delay;r>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}class lr{constructor(e){this._lastTime=-1,this.startIndex=-1,this.endIndex=-1,this.factor=0,this.times=[],this.values=[],this.setKeyFrames(e),this.setTime(0)}setKeyFrames(e){const t=e.length;this.times.length=t,this.values.length=t;for(let r=0;r<t;++r)this.times[r]=e[r][0],this.values[r]=e[r][1];this._calculateKeys(this._lastTime)}setTime(e){(e=Math.max(0,e))!==this._lastTime&&(this._calculateKeys(e),this._lastTime=e)}getStartTime(){return this.times[this.startIndex]}getEndTime(){return this.times[this.endIndex]}getStartData(){return this.values[this.startIndex]}getEndData(){return this.values[this.endIndex]}_calculateKeys(e){let t=0;const r=this.times.length;for(t=0;t<r-2&&!(this.times[t+1]>e);++t);this.startIndex=t,this.endIndex=t+1;const n=this.times[this.startIndex],i=this.times[this.endIndex];this.factor=Math.min(Math.max(0,(e-n)/(i-n)),1)}}function Er(){throw new Error("@luma.gl/addons: `addEvents` is removed. Use `EventManager` from mjolnir.js instead.")}r.d(t,"Display",function(){return s}),r.d(t,"VRDisplay",function(){return o}),r.d(t,"GLTFScenegraphLoader",function(){return sr}),r.d(t,"GLTFEnvironment",function(){return ur}),r.d(t,"createGLTFObjects",function(){return ir}),r.d(t,"Timeline",function(){return hr}),r.d(t,"KeyFrames",function(){return lr}),r.d(t,"addEvents",function(){return Er})}])});